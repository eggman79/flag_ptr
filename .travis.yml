language: cpp

install:
    - cd ${TRAVIS_BUILD_DIR}
    - echo "install..."
    - DEPS_DIR="${TRAVIS_BUILD_DIR}/deps"
    - mkdir ${DEPS_DIR} && cd ${DEPS_DIR}
      # we use wget to fetch the cmake binaries
    - travis_retry wget --no-check-certificate https://cmake.org/files/v3.20/cmake-3.20.0-Linux-x86_64.tar.gz
      # this is optional, but useful:
      # do a quick md5 check to ensure that the archive we downloaded did not get compromised
      # extract the binaries; the output here is quite lengthy,
      # so we swallow it to not clutter up the travis console
    - tar -xvf cmake-3.20.0-Linux-x86_64.tar.gz > /dev/null
    - mv cmake-3.20.0-Linux-x86_64 cmake-install
      # add both the top-level directory and the bin directory from the archive
      # to the system PATH. By adding it to the front of the path we hide the
      # preinstalled CMake with our own.
    - PATH=${DEPS_DIR}/cmake-install:${DEPS_DIR}/cmake-install/bin:$PATH
      # don't forget to switch back to the main build directory once you are done
    - cd ${TRAVIS_BUILD_DIR}
before_script:
    - cd ${TRAVIS_BUILD_DIR}
    - echo "before script..."
    - mkdir build
    - cd build
    - cmake ..
compiler:
    - clang
    - gcc
script:
    - cd ${TRAVIS_BUILD_DIR}
    - echo "script..."
    - make
    - make test
after_success:
    - cd ${TRAVIS_BUILD_DIR}
